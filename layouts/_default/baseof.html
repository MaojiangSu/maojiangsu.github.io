{{- if lt hugo.Version "0.147.2" }}
{{- errorf "=> hugo v0.147.2 or greater is required for hugo-PaperMod to build " }}
{{- end -}}

<!DOCTYPE html>
<html lang="{{ site.Language }}" dir="{{ .Language.LanguageDirection | default "auto" }}">

<head>
    {{- partial "head.html" . }}

    {{/* Only emit Scholar tags for single pages (one paper per page) */}}
    {{ if .IsPage }}
      <!-- Google Scholar / Highwire metadata (robust to many front-matter shapes) -->

      <!-- Title -->
      <meta name="citation_title" content="{{ .Title | html }}">

      <!-- AUTHORS: handle many variants:
           - .Params.author (string | slice | slice of maps)
           - .Params.authors
           - top-level .Authors / .Author (Hugo built-ins)
           - items that are maps with .name or .Name
      -->
      {{ if .Params.author }}
        {{ $a := .Params.author }}
        {{ if kindIs "slice" $a }}
          {{ range $a }}
            {{ if kindIs "map" . }}
              {{ with .name }}<meta name="citation_author" content="{{ . | html }}">{{ end }}
              {{ with .Name }}<meta name="citation_author" content="{{ . | html }}">{{ end }}
            {{ else }}
              <meta name="citation_author" content="{{ . | html }}">
            {{ end }}
          {{ end }}
        {{ else if kindIs "map" $a }}
          {{ with $a.name }}<meta name="citation_author" content="{{ . | html }}">{{ end }}
          {{ with $a.Name }}<meta name="citation_author" content="{{ . | html }}">{{ end }}
        {{ else }}
          <meta name="citation_author" content="{{ $a | html }}">
        {{ end }}

      {{ else if .Params.authors }}
        {{ $a := .Params.authors }}
        {{ if kindIs "slice" $a }}
          {{ range $a }}
            {{ if kindIs "map" . }}
              {{ with .name }}<meta name="citation_author" content="{{ . | html }}">{{ end }}
              {{ with .Name }}<meta name="citation_author" content="{{ . | html }}">{{ end }}
            {{ else }}
              <meta name="citation_author" content="{{ . | html }}">
            {{ end }}
          {{ end }}
        {{ else }}
          <meta name="citation_author" content="{{ $a | html }}">
        {{ end }}

      {{ else if .Authors }}
        {{ range .Authors }}<meta name="citation_author" content="{{ . | html }}">{{ end }}
      {{ else if .Author }}
        <meta name="citation_author" content="{{ .Author | html }}">
      {{ end }}

      <!-- PUBLICATION DATE: try PublishDate, Date, then Params.date -->
      {{ with or .PublishDate .Date .Params.date }}
        <meta name="citation_publication_date" content="{{ .Format "2006/01/02" }}">
      {{ end }}

      <!-- VENUE / CONFERENCE / JOURNAL: try common keys -->
      {{ if .Params.conference }}
        <meta name="citation_conference_title" content="{{ .Params.conference | html }}">
      {{ else if .Params.journal }}
        <meta name="citation_journal_title" content="{{ .Params.journal | html }}">
      {{ else if .Params.booktitle }}
        <meta name="citation_conference_title" content="{{ .Params.booktitle | html }}">
      {{ else if .Params.editPost }}
        {{ with .Params.editPost.Text }}<meta name="citation_conference_title" content="{{ . | html }}">{{ end }}
      {{ end }}

      <!-- PDF URL: try several front-matter keys and page resources (page bundle) -->
      {{ if .Params.pdf }}
        <meta name="citation_pdf_url" content="{{ .Params.pdf }}">
      {{ else if .Params.pdf_url }}
        <meta name="citation_pdf_url" content="{{ .Params.pdf_url }}">
      {{ else if .Params.pdf_file }}
        <meta name="citation_pdf_url" content="{{ printf "%s%s" site.BaseURL .Params.pdf_file }}">
      {{ else if .Params.paper }}
        <meta name="citation_pdf_url" content="{{ .Params.paper }}">
      {{ else }}
        {{ with .Resources.GetMatch "**/*.pdf" }}
          <meta name="citation_pdf_url" content="{{ .Permalink }}">
        {{ end }}
      {{ end }}

      <!-- Optional extras -->
      {{ with .Params.doi }}<meta name="citation_doi" content="{{ . }}">{{ end }}
      {{ with .Params.arxiv }}<meta name="citation_arxiv" content="{{ . }}">{{ end }}
      {{ with .Params.arXiv }}<meta name="citation_arxiv" content="{{ . }}">{{ end }}

    {{ end }}
</head>




<body class="
{{- if (or (ne .Kind `page` ) (eq .Layout `archives`) (eq .Layout `search`)) -}}
{{- print "list" -}}
{{- end -}}
{{- if eq site.Params.defaultTheme `dark` -}}
{{- print " dark" }}
{{- end -}}
" id="top">
    {{- if not .IsHome  }}
    {{- partialCached "header.html" . .Page -}}
    {{- end }}
    <main class="main">
        {{- block "main" . }}{{ end }}
    </main>
    {{ partialCached "footer.html" . .Layout .Kind (.Param "hideFooter") (.Param "ShowCodeCopyButtons") -}}
</body>
</html>
